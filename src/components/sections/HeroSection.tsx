import { useId, useRef } from 'react';
import { Tooltip, TooltipContent, TooltipTrigger } from '../ui/tooltip';
import {
  motion,
  useMotionValue,
  useSpring,
  useTransform,
  useVelocity,
} from 'motion/react';

const HeroSection = () => {
  const containerRef = useRef<HTMLDivElement>(null);
  const filterId = useId();

  const mouseX = useMotionValue(0);
  const mouseY = useMotionValue(0);

  const velocityX = useVelocity(mouseX);
  const velocityY = useVelocity(mouseY);

  const smoothX = useSpring(mouseX, { bounce: 0.05, visualDuration: 0.2 });
  const smoothY = useSpring(mouseY, { bounce: 0.05, visualDuration: 0.2 });

  const x1 = useTransform(smoothX, (v) => v * 0.05);
  const y1 = useTransform(smoothY, (v) => v * 0.05);

  const x2 = useTransform(smoothX, (v) => v * 0.08);
  const y2 = useTransform(smoothY, (v) => v * 0.08);

  const x3 = useTransform(smoothX, (v) => v * 0.04);
  const y3 = useTransform(smoothY, (v) => v * 0.04);

  const x4 = useTransform(smoothX, (v) => v * 0.07);
  const y4 = useTransform(smoothY, (v) => v * 0.07);

  const handleMouseMove = (e: React.MouseEvent) => {
    if (!containerRef.current) return;
    const rect = containerRef.current.getBoundingClientRect();
    const centerX = rect.width / 2;
    const centerY = rect.height / 2;

    mouseX.set(e.clientX - rect.left - centerX);
    mouseY.set(e.clientY - rect.top - centerY);
  };

  const handleMouseLeave = () => {
    mouseX.set(0);
    mouseY.set(0);
  };

  const rawDistortion = useTransform(
    [velocityX, velocityY],
    ([vx, vy]: number[]) => {
      const speed = Math.sqrt(vx * vx + vy * vy); // Pythagorean theorem
      return Math.min(speed / 50, 50); // Cap max distortion at 30
    }
  );

  const distScale = useSpring(rawDistortion, { stiffness: 100, damping: 20 });

  return (
    <section id="top" className="pt-3 mt-12">
      <div
        ref={containerRef}
        onMouseMove={handleMouseMove}
        onMouseLeave={handleMouseLeave}
        className="relative h-[40vh] bg-primary text-primary-foreground"
      >
        <svg
          className="size-full text-foreground"
          viewBox="0 0 167 92"
          fill="currentColor"
          xmlns="http://www.w3.org/2000/svg"
        >
          <defs>
            <filter id={filterId} x="-20%" y="-20%" width="140%" height="140%">
              <feTurbulence
                type="fractalNoise"
                baseFrequency={0.5}
                numOctaves="1"
                result="noise"
              />
              <motion.feDisplacementMap
                in="SourceGraphic"
                in2="noise"
                scale={distScale}
                xChannelSelector="R"
                yChannelSelector="G"
              />
            </filter>
          </defs>
          <Tooltip>
            <TooltipTrigger asChild>
              <motion.path
                style={{ x: x1, y: y1, filter: `url(#${filterId})` }}
                d={PATHS.s}
              />
            </TooltipTrigger>
            <TooltipContent side="left">
              <p>Scalable</p>
            </TooltipContent>
          </Tooltip>
          <Tooltip>
            <TooltipTrigger asChild>
              <motion.path
                style={{ x: x2, y: y2, filter: `url(#${filterId})` }}
                d={PATHS.v}
              />
            </TooltipTrigger>
            <TooltipContent side="bottom">
              <p>Vector</p>
            </TooltipContent>
          </Tooltip>
          <Tooltip>
            <TooltipTrigger asChild>
              <motion.path
                style={{ x: x3, y: y3, filter: `url(#${filterId})` }}
                d={PATHS.a}
              />
            </TooltipTrigger>
            <TooltipContent side="top">
              <p>SWAG</p>
            </TooltipContent>
          </Tooltip>

          <Tooltip>
            <TooltipTrigger asChild>
              <motion.path
                style={{ x: x4, y: y4, filter: `url(#${filterId})` }}
                d={PATHS.g}
              />
            </TooltipTrigger>
            <TooltipContent side="right">
              <p>Graphics</p>
            </TooltipContent>
          </Tooltip>
        </svg>
      </div>
      <hgroup className="mt-6 flex gap-3 flex-col md:flex-row text-balance">
        <h1 className="text-4xl font-medium max-w-[20ch]">
          Exploring the power of{' '}
          <span className="text-primary">Scalable Vector Graphics</span> through
          interactive examples
        </h1>
        <p className="max-w-[65ch]">
          A hands-on exploration of SVG capabilitiesâ€”from basic shapes to
          advanced filter effects. Built with React, Motion, and modern web
          technologies.
        </p>
      </hgroup>
    </section>
  );
};

export default HeroSection;

const PATHS = {
  s: 'M41.472 51.406C41.8133 52.7713 41.984 54.478 41.984 56.526C41.984 58.4887 41.8133 60.1953 41.472 61.646C41.8133 63.0113 41.984 64.718 41.984 66.766C41.984 68.7287 41.8133 70.4353 41.472 71.886H36.352C36.6933 73.2513 36.864 74.958 36.864 77.006C36.864 78.9686 36.6933 80.6753 36.352 82.126H5.632C5.29067 80.6753 5.12 78.9686 5.12 77.006C5.12 74.958 5.29067 73.2513 5.632 71.886H0.512C0.170667 70.4353 0 68.7287 0 66.766C0 64.718 0.170667 63.0113 0.512 61.646H10.752C11.0933 63.0113 11.264 64.718 11.264 66.766C11.264 68.7287 11.0933 70.4353 10.752 71.886H31.232C30.8907 70.4353 30.72 68.7287 30.72 66.766C30.72 64.718 30.8907 63.0113 31.232 61.646C30.8907 60.1953 30.72 58.4887 30.72 56.526C30.72 54.478 30.8907 52.7713 31.232 51.406H5.632C5.29067 49.9553 5.12 48.2487 5.12 46.286C5.12 44.238 5.29067 42.5313 5.632 41.166H0.512C0.170667 39.7153 0 38.0086 0 36.046C0 33.998 0.170667 32.2913 0.512 30.926C0.170667 29.4753 0 27.7686 0 25.806C0 23.758 0.170667 22.0513 0.512 20.686H5.632C5.29067 19.2353 5.12 17.5286 5.12 15.566C5.12 13.518 5.29067 11.8113 5.632 10.446H36.352C36.6933 11.8113 36.864 13.518 36.864 15.566C36.864 17.5286 36.6933 19.2353 36.352 20.686H41.472C41.8133 22.0513 41.984 23.758 41.984 25.806C41.984 27.7686 41.8133 29.4753 41.472 30.926H31.232C30.8907 29.4753 30.72 27.7686 30.72 25.806C30.72 23.758 30.8907 22.0513 31.232 20.686H10.752C11.0933 22.0513 11.264 23.758 11.264 25.806C11.264 27.7686 11.0933 29.4753 10.752 30.926C11.0933 32.2913 11.264 33.998 11.264 36.046C11.264 38.0086 11.0933 39.7153 10.752 41.166H36.352C36.6933 42.5313 36.864 44.238 36.864 46.286C36.864 48.2487 36.6933 49.9553 36.352 51.406H41.472Z',
  v: 'M86.1517 10.24C86.493 11.6053 86.6637 13.312 86.6637 15.36C86.6637 17.3227 86.493 19.0293 86.1517 20.48C86.493 21.8453 86.6637 23.552 86.6637 25.6C86.6637 27.5627 86.493 29.2693 86.1517 30.72H82.3117C82.653 32.0853 82.8237 33.792 82.8237 35.84C82.8237 37.8027 82.653 39.5093 82.3117 40.96H78.4717C78.813 42.3253 78.9837 44.032 78.9837 46.08C78.9837 48.0427 78.813 49.7493 78.4717 51.2H75.9117C76.253 52.5653 76.4237 54.272 76.4237 56.32C76.4237 58.2827 76.253 59.9893 75.9117 61.44H70.7917C71.133 62.8053 71.3037 64.512 71.3037 66.56C71.3037 68.5227 71.133 70.2293 70.7917 71.68H60.5517C60.2104 70.2293 60.0397 68.5227 60.0397 66.56C60.0397 64.512 60.2104 62.8053 60.5517 61.44H55.4317C55.0904 59.9893 54.9197 58.2827 54.9197 56.32C54.9197 54.272 55.0904 52.5653 55.4317 51.2H52.8717C52.5304 49.7493 52.3597 48.0427 52.3597 46.08C52.3597 44.032 52.5304 42.3253 52.8717 40.96H49.0317C48.6904 39.5093 48.5197 37.8027 48.5197 35.84C48.5197 33.792 48.6904 32.0853 49.0317 30.72H45.1917C44.8504 29.2693 44.6797 27.5627 44.6797 25.6C44.6797 23.552 44.8504 21.8453 45.1917 20.48C44.8504 19.0293 44.6797 17.3227 44.6797 15.36C44.6797 13.312 44.8504 11.6053 45.1917 10.24C44.8504 8.78933 44.6797 7.08266 44.6797 5.12C44.6797 3.072 44.8504 1.36533 45.1917 0H55.4317C55.773 1.36533 55.9437 3.072 55.9437 5.12C55.9437 7.08266 55.773 8.78933 55.4317 10.24C55.773 11.6053 55.9437 13.312 55.9437 15.36C55.9437 17.3227 55.773 19.0293 55.4317 20.48C55.773 21.8453 55.9437 23.552 55.9437 25.6C55.9437 27.5627 55.773 29.2693 55.4317 30.72H59.2717C59.613 32.0853 59.7837 33.792 59.7837 35.84C59.7837 37.8027 59.613 39.5093 59.2717 40.96H63.1117C63.453 42.3253 63.6237 44.032 63.6237 46.08C63.6237 48.0427 63.453 49.7493 63.1117 51.2H68.2317C67.8904 49.7493 67.7197 48.0427 67.7197 46.08C67.7197 44.032 67.8904 42.3253 68.2317 40.96H72.0717C71.7304 39.5093 71.5597 37.8027 71.5597 35.84C71.5597 33.792 71.7304 32.0853 72.0717 30.72H75.9117C75.5704 29.2693 75.3997 27.5627 75.3997 25.6C75.3997 23.552 75.5704 21.8453 75.9117 20.48C75.5704 19.0293 75.3997 17.3227 75.3997 15.36C75.3997 13.312 75.5704 11.6053 75.9117 10.24C75.5704 8.78933 75.3997 7.08266 75.3997 5.12C75.3997 3.072 75.5704 1.36533 75.9117 0H86.1517C86.493 1.36533 86.6637 3.072 86.6637 5.12C86.6637 7.08266 86.493 8.78933 86.1517 10.24Z',
  a: 'M122.476 71.886C122.817 73.2513 122.988 74.958 122.988 77.006C122.988 78.9686 122.817 80.6753 122.476 82.126H112.236C111.895 80.6753 111.724 78.9686 111.724 77.006C111.724 74.958 111.895 73.2513 112.236 71.886H107.116C106.775 70.4353 106.604 68.7286 106.604 66.766C106.604 64.718 106.775 63.0113 107.116 61.646H91.7559C92.0972 63.0113 92.2679 64.718 92.2679 66.766C92.2679 68.7286 92.0972 70.4353 91.7559 71.886H107.116C107.457 73.2513 107.628 74.958 107.628 77.006C107.628 78.9686 107.457 80.6753 107.116 82.126H86.6359C86.2946 80.6753 86.1239 78.9686 86.1239 77.006C86.1239 74.958 86.2946 73.2513 86.6359 71.886H81.5159C81.1746 70.4353 81.0039 68.7286 81.0039 66.766C81.0039 64.718 81.1746 63.0113 81.5159 61.646H86.6359C86.2946 60.1953 86.1239 58.4886 86.1239 56.526C86.1239 54.478 86.2946 52.7713 86.6359 51.406H107.116C106.775 49.9553 106.604 48.2486 106.604 46.286C106.604 44.238 106.775 42.5313 107.116 41.166H89.1959C88.8546 39.7153 88.6839 38.0086 88.6839 36.046C88.6839 33.998 88.8546 32.2913 89.1959 30.926H112.236C112.577 32.2913 112.748 33.998 112.748 36.046C112.748 38.0086 112.577 39.7153 112.236 41.166H117.356C117.697 42.5313 117.868 44.238 117.868 46.286C117.868 48.2486 117.697 49.9553 117.356 51.406C117.697 52.7713 117.868 54.478 117.868 56.526C117.868 58.4886 117.697 60.1953 117.356 61.646C117.697 63.0113 117.868 64.718 117.868 66.766C117.868 68.7286 117.697 70.4353 117.356 71.886H122.476Z',
  g: 'M166.046 51.406C166.388 52.7713 166.558 54.478 166.558 56.526C166.558 58.4886 166.388 60.1953 166.046 61.646C166.388 63.0113 166.558 64.718 166.558 66.766C166.558 68.7286 166.388 70.4353 166.046 71.886C166.388 73.2513 166.558 74.958 166.558 77.006C166.558 78.9686 166.388 80.6753 166.046 82.126H160.926C161.268 83.4913 161.438 85.198 161.438 87.246C161.438 89.2086 161.268 90.9153 160.926 92.366H135.326C134.985 90.9153 134.814 89.2086 134.814 87.246C134.814 85.198 134.985 83.4913 135.326 82.126H130.206C129.865 80.6753 129.694 78.9686 129.694 77.006C129.694 74.958 129.865 73.2513 130.206 71.886H125.086C124.745 70.4353 124.574 68.7286 124.574 66.766C124.574 64.718 124.745 63.0113 125.086 61.646C124.745 60.1953 124.574 58.4886 124.574 56.526C124.574 54.478 124.745 52.7713 125.086 51.406C124.745 49.9553 124.574 48.2486 124.574 46.286C124.574 44.238 124.745 42.5313 125.086 41.166H130.206C129.865 39.7153 129.694 38.0086 129.694 36.046C129.694 33.998 129.865 32.2913 130.206 30.926H135.326C134.985 29.4753 134.814 27.7686 134.814 25.806C134.814 23.758 134.985 22.0513 135.326 20.686H160.926C161.268 22.0513 161.438 23.758 161.438 25.806C161.438 27.7686 161.268 29.4753 160.926 30.926H166.046C166.388 32.2913 166.558 33.998 166.558 36.046C166.558 38.0086 166.388 39.7153 166.046 41.166H155.806C155.465 39.7153 155.294 38.0086 155.294 36.046C155.294 33.998 155.465 32.2913 155.806 30.926H140.446C140.788 32.2913 140.958 33.998 140.958 36.046C140.958 38.0086 140.788 39.7153 140.446 41.166H135.326C135.668 42.5313 135.838 44.238 135.838 46.286C135.838 48.2486 135.668 49.9553 135.326 51.406C135.668 52.7713 135.838 54.478 135.838 56.526C135.838 58.4886 135.668 60.1953 135.326 61.646C135.668 63.0113 135.838 64.718 135.838 66.766C135.838 68.7286 135.668 70.4353 135.326 71.886H140.446C140.788 73.2513 140.958 74.958 140.958 77.006C140.958 78.9686 140.788 80.6753 140.446 82.126H155.806C155.465 80.6753 155.294 78.9686 155.294 77.006C155.294 74.958 155.465 73.2513 155.806 71.886C155.465 70.4353 155.294 68.7286 155.294 66.766C155.294 64.718 155.465 63.0113 155.806 61.646H148.126C147.785 60.1953 147.614 58.4886 147.614 56.526C147.614 54.478 147.785 52.7713 148.126 51.406H166.046Z',
};
